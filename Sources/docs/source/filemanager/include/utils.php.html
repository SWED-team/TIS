<!doctype html>

<html lang="en">
<head>

<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">

<meta name="generator" content="PHPDoctor 2.0.5 (http://peej.github.com/phpdoctor/)">
<meta name="when" content="Tue, 26 Jan 2016 23:51:12 +0000">

<link rel="stylesheet" type="text/css" href="../stylesheet.css">
<link rel="start" href="../overview-summary.html">

<title>filemanager\include\utils.php (SWEDTeamTitle)</title>

</head>
<body id="file" onload="parent.document.title=document.title;">

<div class="header">
<h1>RObo cosi header</h1>
<ul>
<li><a href="../overview-summary.html">Overview</a></li>
<li>Package</li><li>Class</li><li>Tree</li><li><a href="../overview-files.html">Files</a></li>
<li><a href="../deprecated-list.html">Deprecated</a></li>
<li><a href="../todo-list.html">Todo</a></li>
<li><a href="../index-all.html">Index</a></li>
</ul>
</div>

<div class="small_links">
<a href="../index.html" target="_top">Frames</a>
<a href="../source\filemanager\include\utils.php.html" target="_top">No frames</a>
</div>
<hr>

<h1>filemanager\include\utils.php</h1>
<hr>

<a name="line1"></a><pre><?php
<a name="line2"></a>
<a name="line3"></a>if ($_SESSION['RF']["verify"] != "RESPONSIVEfilemanager")
<a name="line4"></a>{
<a name="line5"></a>	die('forbiden');
<a name="line6"></a>}
<a name="line7"></a>
<a name="line8"></a>require dirname(__FILE__) . '/Response.php';
<a name="line9"></a>
<a name="line10"></a>if ( ! function_exists('response'))
<a name="line11"></a>{
<a name="line12"></a>	/**
<a name="line13"></a>	 * Response construction helper
<a name="line14"></a>	 *
<a name="line15"></a>	 * @param string $content
<a name="line16"></a>	 * @param int    $statusCode
<a name="line17"></a>	 * @param array  $headers
<a name="line18"></a>	 *
<a name="line19"></a>	 * @return \Response|\Illuminate\Http\Response
<a name="line20"></a>	 */
<a name="line21"></a>	function response($content = '', $statusCode = 200, $headers = array())
<a name="line22"></a>	{
<a name="line23"></a>		$responseClass = class_exists('Illuminate\Http\Response') ? '\Illuminate\Http\Response' : 'Response';
<a name="line24"></a>
<a name="line25"></a>		return new $responseClass($content, $statusCode, $headers);
<a name="line26"></a>	}
<a name="line27"></a>}
<a name="line28"></a>
<a name="line29"></a>if ( ! function_exists('trans'))
<a name="line30"></a>{
<a name="line31"></a>	// language
<a name="line32"></a>	if ( ! isset($_SESSION['RF']['language'])
<a name="line33"></a>		|| file_exists($_SESSION['RF']['language_file']) === false
<a name="line34"></a>		|| ! is_readable($_SESSION['RF']['language_file'])
<a name="line35"></a>	)
<a name="line36"></a>	{
<a name="line37"></a>		$lang = $default_language;
<a name="line38"></a>
<a name="line39"></a>		if (isset($_GET['lang']) && $_GET['lang'] != 'undefined' && $_GET['lang'] != '')
<a name="line40"></a>		{
<a name="line41"></a>			$lang = fix_get_params($_GET['lang']);
<a name="line42"></a>			$lang = trim($lang);
<a name="line43"></a>		}
<a name="line44"></a>
<a name="line45"></a>		$language_file = dirname(dirname(__FILE__)) . '/lang/' . $default_language . '.php';
<a name="line46"></a>		if ($lang != $default_language)
<a name="line47"></a>		{
<a name="line48"></a>			$path_parts = pathinfo($lang);
<a name="line49"></a>
<a name="line50"></a>			if (is_readable(dirname(dirname(__FILE__)) . '/lang/' . $path_parts['basename'] . '.php'))
<a name="line51"></a>			{
<a name="line52"></a>				$language_file = dirname(dirname(__FILE__)) . '/lang/' . $path_parts['basename'] . '.php';
<a name="line53"></a>			}
<a name="line54"></a>			else
<a name="line55"></a>			{
<a name="line56"></a>				echo "<script>console.log('The " . $lang . " language file is not readable! Falling back...');</script>";
<a name="line57"></a>			}
<a name="line58"></a>		}
<a name="line59"></a>
<a name="line60"></a>		// add lang file to session for easy include
<a name="line61"></a>		$_SESSION['RF']['language'] = $lang;
<a name="line62"></a>		$_SESSION['RF']['language_file'] = $language_file;
<a name="line63"></a>	}
<a name="line64"></a>	else
<a name="line65"></a>	{
<a name="line66"></a>		$lang = $_SESSION['RF']['language'];
<a name="line67"></a>		$language_file = $_SESSION['RF']['language_file'];
<a name="line68"></a>	}
<a name="line69"></a>
<a name="line70"></a>	$lang_vars = include $language_file;
<a name="line71"></a>
<a name="line72"></a>	if ( ! is_array($lang_vars))
<a name="line73"></a>	{
<a name="line74"></a>		$lang_vars = array();
<a name="line75"></a>	}
<a name="line76"></a>	/**
<a name="line77"></a>	 * Translate language variable
<a name="line78"></a>	 *
<a name="line79"></a>	 * @param $var string name
<a name="line80"></a>	 *
<a name="line81"></a>	 * @return string translated variable
<a name="line82"></a>	 */
<a name="line83"></a>	function trans($var)
<a name="line84"></a>	{
<a name="line85"></a>		global $lang_vars;
<a name="line86"></a>
<a name="line87"></a>		return (array_key_exists($var, $lang_vars)) ? $lang_vars[ $var ] : $var;
<a name="line88"></a>	}
<a name="line89"></a>}
<a name="line90"></a>
<a name="line91"></a>/**
<a name="line92"></a> * Delete directory
<a name="line93"></a> *
<a name="line94"></a> * @param  string  $dir
<a name="line95"></a> *
<a name="line96"></a> * @return  bool
<a name="line97"></a> */
<a name="line98"></a>function deleteDir($dir)
<a name="line99"></a>{
<a name="line100"></a>	if ( ! file_exists($dir))
<a name="line101"></a>	{
<a name="line102"></a>		return true;
<a name="line103"></a>	}
<a name="line104"></a>	if ( ! is_dir($dir))
<a name="line105"></a>	{
<a name="line106"></a>		return unlink($dir);
<a name="line107"></a>	}
<a name="line108"></a>	foreach (scandir($dir) as $item)
<a name="line109"></a>	{
<a name="line110"></a>		if ($item == '.' || $item == '..')
<a name="line111"></a>		{
<a name="line112"></a>			continue;
<a name="line113"></a>		}
<a name="line114"></a>		if ( ! deleteDir($dir . DIRECTORY_SEPARATOR . $item))
<a name="line115"></a>		{
<a name="line116"></a>			return false;
<a name="line117"></a>		}
<a name="line118"></a>	}
<a name="line119"></a>
<a name="line120"></a>	return rmdir($dir);
<a name="line121"></a>}
<a name="line122"></a>
<a name="line123"></a>/**
<a name="line124"></a> * Make a file copy
<a name="line125"></a> *
<a name="line126"></a> * @param  string  $old_path
<a name="line127"></a> * @param  string  $name      New file name without extension
<a name="line128"></a> *
<a name="line129"></a> * @return  bool
<a name="line130"></a> */
<a name="line131"></a>function duplicate_file($old_path, $name)
<a name="line132"></a>{
<a name="line133"></a>	if (file_exists($old_path))
<a name="line134"></a>	{
<a name="line135"></a>		$info = pathinfo($old_path);
<a name="line136"></a>		$new_path = $info['dirname'] . "/" . $name . "." . $info['extension'];
<a name="line137"></a>		if (file_exists($new_path) && $old_path == $new_path)
<a name="line138"></a>		{
<a name="line139"></a>			return false;
<a name="line140"></a>		}
<a name="line141"></a>
<a name="line142"></a>		return copy($old_path, $new_path);
<a name="line143"></a>	}
<a name="line144"></a>}
<a name="line145"></a>
<a name="line146"></a>
<a name="line147"></a>/**
<a name="line148"></a> * Rename file
<a name="line149"></a> *
<a name="line150"></a> * @param  string  $old_path         File to rename
<a name="line151"></a> * @param  string  $name             New file name without extension
<a name="line152"></a> * @param  bool    $transliteration
<a name="line153"></a> *
<a name="line154"></a> * @return bool
<a name="line155"></a> */
<a name="line156"></a>function rename_file($old_path, $name, $transliteration)
<a name="line157"></a>{
<a name="line158"></a>	$name = fix_filename($name, $transliteration);
<a name="line159"></a>	if (file_exists($old_path))
<a name="line160"></a>	{
<a name="line161"></a>		$info = pathinfo($old_path);
<a name="line162"></a>		$new_path = $info['dirname'] . "/" . $name . "." . $info['extension'];
<a name="line163"></a>		if (file_exists($new_path) && $old_path == $new_path)
<a name="line164"></a>		{
<a name="line165"></a>			return false;
<a name="line166"></a>		}
<a name="line167"></a>
<a name="line168"></a>		return rename($old_path, $new_path);
<a name="line169"></a>	}
<a name="line170"></a>}
<a name="line171"></a>
<a name="line172"></a>/**
<a name="line173"></a> * Rename directory
<a name="line174"></a> *
<a name="line175"></a> * @param  string  $old_path         Directory to rename
<a name="line176"></a> * @param  string  $name             New directory name
<a name="line177"></a> * @param  bool    $transliteration
<a name="line178"></a> *
<a name="line179"></a> * @return bool
<a name="line180"></a> */
<a name="line181"></a>function rename_folder($old_path, $name, $transliteration)
<a name="line182"></a>{
<a name="line183"></a>	$name = fix_filename($name, $transliteration, false, '_', true);
<a name="line184"></a>	if (file_exists($old_path))
<a name="line185"></a>	{
<a name="line186"></a>		$new_path = fix_dirname($old_path) . "/" . $name;
<a name="line187"></a>		if (file_exists($new_path) && $old_path == $new_path)
<a name="line188"></a>		{
<a name="line189"></a>			return false;
<a name="line190"></a>		}
<a name="line191"></a>
<a name="line192"></a>		return rename($old_path, $new_path);
<a name="line193"></a>	}
<a name="line194"></a>}
<a name="line195"></a>
<a name="line196"></a>/**
<a name="line197"></a> * Create new image from existing file
<a name="line198"></a> *
<a name="line199"></a> * @param  string  $imgfile    Source image file name
<a name="line200"></a> * @param  string  $imgthumb   Thumbnail file name
<a name="line201"></a> * @param  int     $newwidth   Thumbnail width
<a name="line202"></a> * @param  int     $newheight  Optional thumbnail height
<a name="line203"></a> * @param  string  $option     Type of resize
<a name="line204"></a> *
<a name="line205"></a> * @return bool
<a name="line206"></a> * @throws \Exception
<a name="line207"></a> */
<a name="line208"></a>function create_img($imgfile, $imgthumb, $newwidth, $newheight = null, $option = "crop")
<a name="line209"></a>{
<a name="line210"></a>	$result = false;
<a name="line211"></a>	if(file_exists($imgfile) || strpos($imgfile,'http')===0){
<a name="line212"></a>		$timeLimit = ini_get('max_execution_time');
<a name="line213"></a>		set_time_limit(30);
<a name="line214"></a>		if (strpos($imgfile,'http')===0 || image_check_memory_usage($imgfile, $newwidth, $newheight))
<a name="line215"></a>		{
<a name="line216"></a>			require_once('php_image_magician.php');
<a name="line217"></a>			$magicianObj = new imageLib($imgfile);
<a name="line218"></a>			$magicianObj->resizeImage($newwidth, $newheight, $option);
<a name="line219"></a>			$magicianObj->saveImage($imgthumb, 80);
<a name="line220"></a>			$result = true;
<a name="line221"></a>		}
<a name="line222"></a>		set_time_limit($timeLimit);
<a name="line223"></a>	}
<a name="line224"></a>	return $result;
<a name="line225"></a>}
<a name="line226"></a>
<a name="line227"></a>/**
<a name="line228"></a> * Convert convert size in bytes to human readable
<a name="line229"></a> *
<a name="line230"></a> * @param  int  $size
<a name="line231"></a> *
<a name="line232"></a> * @return  string
<a name="line233"></a> */
<a name="line234"></a>function makeSize($size)
<a name="line235"></a>{
<a name="line236"></a>	$units = array( 'B', 'KB', 'MB', 'GB', 'TB' );
<a name="line237"></a>	$u = 0;
<a name="line238"></a>	while ((round($size / 1024) > 0) && ($u < 4))
<a name="line239"></a>	{
<a name="line240"></a>		$size = $size / 1024;
<a name="line241"></a>		$u++;
<a name="line242"></a>	}
<a name="line243"></a>
<a name="line244"></a>	return (number_format($size, 0) . " " . $units[ $u ]);
<a name="line245"></a>}
<a name="line246"></a>
<a name="line247"></a>/**
<a name="line248"></a> * Determine directory size
<a name="line249"></a> *
<a name="line250"></a> * @param  string  $path
<a name="line251"></a> *
<a name="line252"></a> * @return  int
<a name="line253"></a> */
<a name="line254"></a>function folder_info($path)
<a name="line255"></a>{
<a name="line256"></a>	$total_size = 0;
<a name="line257"></a>	$files = scandir($path);
<a name="line258"></a>	$cleanPath = rtrim($path, '/') . '/';
<a name="line259"></a>	$files_count = 0;
<a name="line260"></a>	$folders_count = 0;
<a name="line261"></a>	foreach ($files as $t)
<a name="line262"></a>	{
<a name="line263"></a>		if ($t != "." && $t != "..")
<a name="line264"></a>		{
<a name="line265"></a>			$currentFile = $cleanPath . $t;
<a name="line266"></a>			if (is_dir($currentFile))
<a name="line267"></a>			{
<a name="line268"></a>				list($size,$tmp,$tmp1) = folder_info($currentFile);
<a name="line269"></a>				$total_size += $size;
<a name="line270"></a>				$folders_count ++;
<a name="line271"></a>			}
<a name="line272"></a>			else
<a name="line273"></a>			{
<a name="line274"></a>				$size = filesize($currentFile);
<a name="line275"></a>				$total_size += $size;
<a name="line276"></a>				$files_count++;
<a name="line277"></a>			}
<a name="line278"></a>		}
<a name="line279"></a>	}
<a name="line280"></a>
<a name="line281"></a>	return array($total_size,$files_count,$folders_count);
<a name="line282"></a>}
<a name="line283"></a>
<a name="line284"></a>/**
<a name="line285"></a> * Get number of files in a directory
<a name="line286"></a> *
<a name="line287"></a> * @param  string  $path
<a name="line288"></a> *
<a name="line289"></a> * @return  int
<a name="line290"></a> */
<a name="line291"></a>function filescount($path)
<a name="line292"></a>{
<a name="line293"></a>	$total_count = 0;
<a name="line294"></a>	$files = scandir($path);
<a name="line295"></a>	$cleanPath = rtrim($path, '/') . '/';
<a name="line296"></a>
<a name="line297"></a>	foreach ($files as $t)
<a name="line298"></a>	{
<a name="line299"></a>		if ($t != "." && $t != "..")
<a name="line300"></a>		{
<a name="line301"></a>			$currentFile = $cleanPath . $t;
<a name="line302"></a>			if (is_dir($currentFile))
<a name="line303"></a>			{
<a name="line304"></a>				$size = filescount($currentFile);
<a name="line305"></a>				$total_count += $size;
<a name="line306"></a>			}
<a name="line307"></a>			else
<a name="line308"></a>			{
<a name="line309"></a>				$total_count += 1;
<a name="line310"></a>			}
<a name="line311"></a>		}
<a name="line312"></a>	}
<a name="line313"></a>
<a name="line314"></a>	return $total_count;
<a name="line315"></a>}
<a name="line316"></a>
<a name="line317"></a>/**
<a name="line318"></a> * Create directory for images and/or thumbnails
<a name="line319"></a> *
<a name="line320"></a> * @param  string  $path
<a name="line321"></a> * @param  string  $path_thumbs
<a name="line322"></a> */
<a name="line323"></a>function create_folder($path = null, $path_thumbs = null)
<a name="line324"></a>{
<a name="line325"></a>	$oldumask = umask(0);
<a name="line326"></a>	if ($path && ! file_exists($path))
<a name="line327"></a>	{
<a name="line328"></a>		mkdir($path, 0755, true);
<a name="line329"></a>	} // or even 01777 so you get the sticky bit set
<a name="line330"></a>	if ($path_thumbs && ! file_exists($path_thumbs))
<a name="line331"></a>	{
<a name="line332"></a>		mkdir($path_thumbs, 0755, true) or die("$path_thumbs cannot be found");
<a name="line333"></a>	} // or even 01777 so you get the sticky bit set
<a name="line334"></a>	umask($oldumask);
<a name="line335"></a>}
<a name="line336"></a>
<a name="line337"></a>/**
<a name="line338"></a> * Get file extension present in directory
<a name="line339"></a> *
<a name="line340"></a> * @param  string  $path
<a name="line341"></a> * @param  string  $ext
<a name="line342"></a> */
<a name="line343"></a>function check_files_extensions_on_path($path, $ext)
<a name="line344"></a>{
<a name="line345"></a>	if ( ! is_dir($path))
<a name="line346"></a>	{
<a name="line347"></a>		$fileinfo = pathinfo($path);
<a name="line348"></a>		if ( ! in_array(mb_strtolower($fileinfo['extension']), $ext))
<a name="line349"></a>		{
<a name="line350"></a>			unlink($path);
<a name="line351"></a>		}
<a name="line352"></a>	}
<a name="line353"></a>	else
<a name="line354"></a>	{
<a name="line355"></a>		$files = scandir($path);
<a name="line356"></a>		foreach ($files as $file)
<a name="line357"></a>		{
<a name="line358"></a>			check_files_extensions_on_path(trim($path, '/') . "/" . $file, $ext);
<a name="line359"></a>		}
<a name="line360"></a>	}
<a name="line361"></a>}
<a name="line362"></a>
<a name="line363"></a>/**
<a name="line364"></a> * Get file extension present in PHAR file
<a name="line365"></a> *
<a name="line366"></a> * @param  string  $phar
<a name="line367"></a> * @param  array   $files
<a name="line368"></a> * @param  string  $basepath
<a name="line369"></a> * @param  string  $ext
<a name="line370"></a> */
<a name="line371"></a>function check_files_extensions_on_phar($phar, &$files, $basepath, $ext)
<a name="line372"></a>{
<a name="line373"></a>	foreach ($phar as $file)
<a name="line374"></a>	{
<a name="line375"></a>		if ($file->isFile())
<a name="line376"></a>		{
<a name="line377"></a>			if (in_array(mb_strtolower($file->getExtension()), $ext))
<a name="line378"></a>			{
<a name="line379"></a>				$files[] = $basepath . $file->getFileName();
<a name="line380"></a>			}
<a name="line381"></a>		}
<a name="line382"></a>		else
<a name="line383"></a>		{
<a name="line384"></a>			if ($file->isDir())
<a name="line385"></a>			{
<a name="line386"></a>				$iterator = new DirectoryIterator($file);
<a name="line387"></a>				check_files_extensions_on_phar($iterator, $files, $basepath . $file->getFileName() . '/', $ext);
<a name="line388"></a>			}
<a name="line389"></a>		}
<a name="line390"></a>	}
<a name="line391"></a>}
<a name="line392"></a>
<a name="line393"></a>/**
<a name="line394"></a> * Cleanup input
<a name="line395"></a> *
<a name="line396"></a> * @param  string  $str
<a name="line397"></a> *
<a name="line398"></a> * @return  string
<a name="line399"></a> */
<a name="line400"></a>function fix_get_params($str)
<a name="line401"></a>{
<a name="line402"></a>	return strip_tags(preg_replace("/[^a-zA-Z0-9\.\[\]_| -]/", '', $str));
<a name="line403"></a>}
<a name="line404"></a>
<a name="line405"></a>/**
<a name="line406"></a> * Cleanup filename
<a name="line407"></a> *
<a name="line408"></a> * @param  string  $str
<a name="line409"></a> * @param  bool    $transliteration
<a name="line410"></a> * @param  bool    $convert_spaces
<a name="line411"></a> * @param  string  $replace_with
<a name="line412"></a> * @param  bool    $is_folder
<a name="line413"></a> *
<a name="line414"></a> * @return string
<a name="line415"></a> */
<a name="line416"></a>function fix_filename($str, $transliteration, $convert_spaces = false, $replace_with = "_", $is_folder = false)
<a name="line417"></a>{
<a name="line418"></a>	if ($convert_spaces)
<a name="line419"></a>	{
<a name="line420"></a>		$str = str_replace(' ', $replace_with, $str);
<a name="line421"></a>	}
<a name="line422"></a>
<a name="line423"></a>	if ($transliteration)
<a name="line424"></a>	{
<a name="line425"></a>		if (function_exists('transliterator_transliterate'))
<a name="line426"></a>		{
<a name="line427"></a>			 $str = transliterator_transliterate('Accents-Any', utf8_encode($str));
<a name="line428"></a>		}
<a name="line429"></a>		else
<a name="line430"></a>		{
<a name="line431"></a>			$str = iconv('UTF-8', 'ASCII//TRANSLIT//IGNORE', $str);
<a name="line432"></a>		}
<a name="line433"></a>
<a name="line434"></a>		$str = preg_replace("/[^a-zA-Z0-9\.\[\]_| -]/", '', $str);
<a name="line435"></a>	}
<a name="line436"></a>
<a name="line437"></a>	$str = str_replace(array( '"', "'", "/", "\\" ), "", $str);
<a name="line438"></a>	$str = strip_tags($str);
<a name="line439"></a>
<a name="line440"></a>	// Empty or incorrectly transliterated filename.
<a name="line441"></a>	// Here is a point: a good file UNKNOWN_LANGUAGE.jpg could become .jpg in previous code.
<a name="line442"></a>	// So we add that default 'file' name to fix that issue.
<a name="line443"></a>	if (strpos($str, '.') === 0 && $is_folder === false)
<a name="line444"></a>	{
<a name="line445"></a>		$str = 'file' . $str;
<a name="line446"></a>	}
<a name="line447"></a>
<a name="line448"></a>	return trim($str);
<a name="line449"></a>}
<a name="line450"></a>
<a name="line451"></a>/**
<a name="line452"></a> * Cleanup directory name
<a name="line453"></a> *
<a name="line454"></a> * @param  string  $str
<a name="line455"></a> *
<a name="line456"></a> * @return  string
<a name="line457"></a> */
<a name="line458"></a>function fix_dirname($str)
<a name="line459"></a>{
<a name="line460"></a>	return str_replace('~', ' ', dirname(str_replace(' ', '~', $str)));
<a name="line461"></a>}
<a name="line462"></a>
<a name="line463"></a>/**
<a name="line464"></a> * Correct strtoupper handling
<a name="line465"></a> *
<a name="line466"></a> * @param  string  $str
<a name="line467"></a> *
<a name="line468"></a> * @return  string
<a name="line469"></a> */
<a name="line470"></a>function fix_strtoupper($str)
<a name="line471"></a>{
<a name="line472"></a>	if (function_exists('mb_strtoupper'))
<a name="line473"></a>	{
<a name="line474"></a>		return mb_strtoupper($str);
<a name="line475"></a>	}
<a name="line476"></a>	else
<a name="line477"></a>	{
<a name="line478"></a>		return strtoupper($str);
<a name="line479"></a>	}
<a name="line480"></a>}
<a name="line481"></a>
<a name="line482"></a>/**
<a name="line483"></a> * Correct strtolower handling
<a name="line484"></a> *
<a name="line485"></a> * @param  string  $str
<a name="line486"></a> *
<a name="line487"></a> * @return  string
<a name="line488"></a> */
<a name="line489"></a>function fix_strtolower($str)
<a name="line490"></a>{
<a name="line491"></a>	if (function_exists('mb_strtoupper'))
<a name="line492"></a>	{
<a name="line493"></a>		return mb_strtolower($str);
<a name="line494"></a>	}
<a name="line495"></a>	else
<a name="line496"></a>	{
<a name="line497"></a>		return strtolower($str);
<a name="line498"></a>	}
<a name="line499"></a>}
<a name="line500"></a>
<a name="line501"></a>function fix_path($path, $transliteration, $convert_spaces = false, $replace_with = "_")
<a name="line502"></a>{
<a name="line503"></a>	$info = pathinfo($path);
<a name="line504"></a>	$tmp_path = $info['dirname'];
<a name="line505"></a>	$str = fix_filename($info['filename'], $transliteration, $convert_spaces, $replace_with);
<a name="line506"></a>	if ($tmp_path != "")
<a name="line507"></a>	{
<a name="line508"></a>		return $tmp_path . DIRECTORY_SEPARATOR . $str;
<a name="line509"></a>	}
<a name="line510"></a>	else
<a name="line511"></a>	{
<a name="line512"></a>		return $str;
<a name="line513"></a>	}
<a name="line514"></a>}
<a name="line515"></a>
<a name="line516"></a>/**
<a name="line517"></a> * Get current base url
<a name="line518"></a> *
<a name="line519"></a> * @return  string
<a name="line520"></a> */
<a name="line521"></a>function base_url()
<a name="line522"></a>{
<a name="line523"></a>	return sprintf(
<a name="line524"></a>		"%s://%s",
<a name="line525"></a>		isset($_SERVER['HTTPS']) && $_SERVER['HTTPS'] != 'off' ? 'https' : 'http',
<a name="line526"></a>		$_SERVER['HTTP_HOST']
<a name="line527"></a>	);
<a name="line528"></a>}
<a name="line529"></a>
<a name="line530"></a>/**
<a name="line531"></a> * @param  $current_path
<a name="line532"></a> * @param  $fld
<a name="line533"></a> *
<a name="line534"></a> * @return  bool
<a name="line535"></a> */
<a name="line536"></a>function config_loading($current_path, $fld)
<a name="line537"></a>{
<a name="line538"></a>	if (file_exists($current_path . $fld . ".config"))
<a name="line539"></a>	{
<a name="line540"></a>		require_once($current_path . $fld . ".config");
<a name="line541"></a>
<a name="line542"></a>		return true;
<a name="line543"></a>	}
<a name="line544"></a>	echo "!!!!" . $parent = fix_dirname($fld);
<a name="line545"></a>	if ($parent != "." && ! empty($parent))
<a name="line546"></a>	{
<a name="line547"></a>		config_loading($current_path, $parent);
<a name="line548"></a>	}
<a name="line549"></a>
<a name="line550"></a>	return false;
<a name="line551"></a>}
<a name="line552"></a>
<a name="line553"></a>/**
<a name="line554"></a> * Check if memory is enough to process image
<a name="line555"></a> *
<a name="line556"></a> * @param  string  $img
<a name="line557"></a> * @param  int     $max_breedte
<a name="line558"></a> * @param  int     $max_hoogte
<a name="line559"></a> *
<a name="line560"></a> * @return bool
<a name="line561"></a> */
<a name="line562"></a>function image_check_memory_usage($img, $max_breedte, $max_hoogte)
<a name="line563"></a>{
<a name="line564"></a>	if (file_exists($img))
<a name="line565"></a>	{
<a name="line566"></a>		$K64 = 65536; // number of bytes in 64K
<a name="line567"></a>		$memory_usage = memory_get_usage();
<a name="line568"></a>		$memory_limit = abs(intval(str_replace('M', '', ini_get('memory_limit')) * 1024 * 1024));
<a name="line569"></a>		$image_properties = getimagesize($img);
<a name="line570"></a>		$image_width = $image_properties[0];
<a name="line571"></a>		$image_height = $image_properties[1];
<a name="line572"></a>		if (isset($image_properties['bits'])) 
<a name="line573"></a>			$image_bits = $image_properties['bits']; 
<a name="line574"></a>		else 
<a name="line575"></a>			$image_bits = 0;
<a name="line576"></a>		$image_memory_usage = $K64 + ($image_width * $image_height * ($image_bits) * 2);
<a name="line577"></a>		$thumb_memory_usage = $K64 + ($max_breedte * $max_hoogte * ($image_bits) * 2);
<a name="line578"></a>		$memory_needed = intval($memory_usage + $image_memory_usage + $thumb_memory_usage);
<a name="line579"></a>
<a name="line580"></a>		if ($memory_needed > $memory_limit)
<a name="line581"></a>		{
<a name="line582"></a>			ini_set('memory_limit', (intval($memory_needed / 1024 / 1024) + 5) . 'M');
<a name="line583"></a>			if (ini_get('memory_limit') == (intval($memory_needed / 1024 / 1024) + 5) . 'M')
<a name="line584"></a>			{
<a name="line585"></a>				return true;
<a name="line586"></a>			}
<a name="line587"></a>			else
<a name="line588"></a>			{
<a name="line589"></a>				return false;
<a name="line590"></a>			}
<a name="line591"></a>		}
<a name="line592"></a>		else
<a name="line593"></a>		{
<a name="line594"></a>			return true;
<a name="line595"></a>		}
<a name="line596"></a>	}
<a name="line597"></a>	else
<a name="line598"></a>	{
<a name="line599"></a>		return false;
<a name="line600"></a>	}
<a name="line601"></a>}
<a name="line602"></a>
<a name="line603"></a>/**
<a name="line604"></a> * Check is string is ended with needle
<a name="line605"></a> *
<a name="line606"></a> * @param  string  $haystack
<a name="line607"></a> * @param  string  $needle
<a name="line608"></a> *
<a name="line609"></a> * @return  bool
<a name="line610"></a> */
<a name="line611"></a>function endsWith($haystack, $needle)
<a name="line612"></a>{
<a name="line613"></a>	return $needle === "" || substr($haystack, -strlen($needle)) === $needle;
<a name="line614"></a>}
<a name="line615"></a>
<a name="line616"></a>/**
<a name="line617"></a> * TODO REFACTOR THIS!
<a name="line618"></a> *
<a name="line619"></a> * @param $targetPath
<a name="line620"></a> * @param $targetFile
<a name="line621"></a> * @param $name
<a name="line622"></a> * @param $current_path
<a name="line623"></a> * @param $relative_image_creation
<a name="line624"></a> * @param $relative_path_from_current_pos
<a name="line625"></a> * @param $relative_image_creation_name_to_prepend
<a name="line626"></a> * @param $relative_image_creation_name_to_append
<a name="line627"></a> * @param $relative_image_creation_width
<a name="line628"></a> * @param $relative_image_creation_height
<a name="line629"></a> * @param $relative_image_creation_option
<a name="line630"></a> * @param $fixed_image_creation
<a name="line631"></a> * @param $fixed_path_from_filemanager
<a name="line632"></a> * @param $fixed_image_creation_name_to_prepend
<a name="line633"></a> * @param $fixed_image_creation_to_append
<a name="line634"></a> * @param $fixed_image_creation_width
<a name="line635"></a> * @param $fixed_image_creation_height
<a name="line636"></a> * @param $fixed_image_creation_option
<a name="line637"></a> *
<a name="line638"></a> * @return bool
<a name="line639"></a> */
<a name="line640"></a>function new_thumbnails_creation($targetPath, $targetFile, $name, $current_path, $relative_image_creation, $relative_path_from_current_pos, $relative_image_creation_name_to_prepend, $relative_image_creation_name_to_append, $relative_image_creation_width, $relative_image_creation_height, $relative_image_creation_option, $fixed_image_creation, $fixed_path_from_filemanager, $fixed_image_creation_name_to_prepend, $fixed_image_creation_to_append, $fixed_image_creation_width, $fixed_image_creation_height, $fixed_image_creation_option)
<a name="line641"></a>{
<a name="line642"></a>	//create relative thumbs
<a name="line643"></a>	$all_ok = true;
<a name="line644"></a>	if ($relative_image_creation)
<a name="line645"></a>	{
<a name="line646"></a>		foreach ($relative_path_from_current_pos as $k => $path)
<a name="line647"></a>		{
<a name="line648"></a>			if ($path != "" && $path[ strlen($path) - 1 ] != "/")
<a name="line649"></a>			{
<a name="line650"></a>				$path .= "/";
<a name="line651"></a>			}
<a name="line652"></a>			if ( ! file_exists($targetPath . $path))
<a name="line653"></a>			{
<a name="line654"></a>				create_folder($targetPath . $path, false);
<a name="line655"></a>			}
<a name="line656"></a>			$info = pathinfo($name);
<a name="line657"></a>			if ( ! endsWith($targetPath, $path))
<a name="line658"></a>			{
<a name="line659"></a>				if ( ! create_img($targetFile, $targetPath . $path . $relative_image_creation_name_to_prepend[ $k ] . $info['filename'] . $relative_image_creation_name_to_append[ $k ] . "." . $info['extension'], $relative_image_creation_width[ $k ], $relative_image_creation_height[ $k ], $relative_image_creation_option[ $k ]))
<a name="line660"></a>				{
<a name="line661"></a>					$all_ok = false;
<a name="line662"></a>				}
<a name="line663"></a>			}
<a name="line664"></a>		}
<a name="line665"></a>	}
<a name="line666"></a>
<a name="line667"></a>	//create fixed thumbs
<a name="line668"></a>	if ($fixed_image_creation)
<a name="line669"></a>	{
<a name="line670"></a>		foreach ($fixed_path_from_filemanager as $k => $path)
<a name="line671"></a>		{
<a name="line672"></a>			if ($path != "" && $path[ strlen($path) - 1 ] != "/")
<a name="line673"></a>			{
<a name="line674"></a>				$path .= "/";
<a name="line675"></a>			}
<a name="line676"></a>			$base_dir = $path . substr_replace($targetPath, '', 0, strlen($current_path));
<a name="line677"></a>			if ( ! file_exists($base_dir))
<a name="line678"></a>			{
<a name="line679"></a>				create_folder($base_dir, false);
<a name="line680"></a>			}
<a name="line681"></a>			$info = pathinfo($name);
<a name="line682"></a>			if ( ! create_img($targetFile, $base_dir . $fixed_image_creation_name_to_prepend[ $k ] . $info['filename'] . $fixed_image_creation_to_append[ $k ] . "." . $info['extension'], $fixed_image_creation_width[ $k ], $fixed_image_creation_height[ $k ], $fixed_image_creation_option[ $k ]))
<a name="line683"></a>			{
<a name="line684"></a>				$all_ok = false;
<a name="line685"></a>			}
<a name="line686"></a>		}
<a name="line687"></a>	}
<a name="line688"></a>
<a name="line689"></a>	return $all_ok;
<a name="line690"></a>}
<a name="line691"></a>
<a name="line692"></a>
<a name="line693"></a>/**
<a name="line694"></a> * Get a remote file, using whichever mechanism is enabled
<a name="line695"></a> *
<a name="line696"></a> * @param  string  $url
<a name="line697"></a> *
<a name="line698"></a> * @return  bool|mixed|string
<a name="line699"></a> */
<a name="line700"></a>function get_file_by_url($url)
<a name="line701"></a>{
<a name="line702"></a>	if (ini_get('allow_url_fopen'))
<a name="line703"></a>	{
<a name="line704"></a>		return file_get_contents($url);
<a name="line705"></a>	}
<a name="line706"></a>	if ( ! function_exists('curl_version'))
<a name="line707"></a>	{
<a name="line708"></a>		return false;
<a name="line709"></a>	}
<a name="line710"></a>
<a name="line711"></a>	$ch = curl_init();
<a name="line712"></a>
<a name="line713"></a>	curl_setopt($ch, CURLOPT_HEADER, 0);
<a name="line714"></a>	curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);
<a name="line715"></a>	curl_setopt($ch, CURLOPT_URL, $url);
<a name="line716"></a>
<a name="line717"></a>	$data = curl_exec($ch);
<a name="line718"></a>	curl_close($ch);
<a name="line719"></a>
<a name="line720"></a>	return $data;
<a name="line721"></a>}
<a name="line722"></a>
<a name="line723"></a>/**
<a name="line724"></a> * test for dir/file writability properly
<a name="line725"></a> *
<a name="line726"></a> * @param  string  $dir
<a name="line727"></a> *
<a name="line728"></a> * @return  bool
<a name="line729"></a> */
<a name="line730"></a>function is_really_writable($dir)
<a name="line731"></a>{
<a name="line732"></a>	$dir = rtrim($dir, '/');
<a name="line733"></a>	// linux, safe off
<a name="line734"></a>	if (DIRECTORY_SEPARATOR == '/' && @ini_get("safe_mode") == false)
<a name="line735"></a>	{
<a name="line736"></a>		return is_writable($dir);
<a name="line737"></a>	}
<a name="line738"></a>
<a name="line739"></a>	// Windows, safe ON. (have to write a file :S)
<a name="line740"></a>	if (is_dir($dir))
<a name="line741"></a>	{
<a name="line742"></a>		$dir = $dir . '/' . md5(mt_rand(1, 1000) . mt_rand(1, 1000));
<a name="line743"></a>
<a name="line744"></a>		if (($fp = @fopen($dir, 'ab')) === false)
<a name="line745"></a>		{
<a name="line746"></a>			return false;
<a name="line747"></a>		}
<a name="line748"></a>
<a name="line749"></a>		fclose($fp);
<a name="line750"></a>		@chmod($dir, 0755);
<a name="line751"></a>		@unlink($dir);
<a name="line752"></a>
<a name="line753"></a>		return true;
<a name="line754"></a>	}
<a name="line755"></a>	elseif ( ! is_file($dir) || ($fp = @fopen($dir, 'ab')) === false)
<a name="line756"></a>	{
<a name="line757"></a>		return false;
<a name="line758"></a>	}
<a name="line759"></a>
<a name="line760"></a>	fclose($fp);
<a name="line761"></a>
<a name="line762"></a>	return true;
<a name="line763"></a>}
<a name="line764"></a>
<a name="line765"></a>/**
<a name="line766"></a> * Check if a function is callable.
<a name="line767"></a> * Some servers disable copy,rename etc.
<a name="line768"></a> *
<a name="line769"></a> * @parm  string  $name
<a name="line770"></a> *
<a name="line771"></a> * @return  bool
<a name="line772"></a> */
<a name="line773"></a>function is_function_callable($name)
<a name="line774"></a>{
<a name="line775"></a>	if (function_exists($name) === false)
<a name="line776"></a>	{
<a name="line777"></a>		return false;
<a name="line778"></a>	}
<a name="line779"></a>	$disabled = explode(',', ini_get('disable_functions'));
<a name="line780"></a>
<a name="line781"></a>	return ! in_array($name, $disabled);
<a name="line782"></a>}
<a name="line783"></a>
<a name="line784"></a>/**
<a name="line785"></a> * recursivly copies everything
<a name="line786"></a> *
<a name="line787"></a> * @param  string  $source
<a name="line788"></a> * @param  string  $destination
<a name="line789"></a> * @param  bool    $is_rec
<a name="line790"></a> */
<a name="line791"></a>function rcopy($source, $destination, $is_rec = false)
<a name="line792"></a>{
<a name="line793"></a>	if (is_dir($source))
<a name="line794"></a>	{
<a name="line795"></a>		if ($is_rec === false)
<a name="line796"></a>		{
<a name="line797"></a>			$pinfo = pathinfo($source);
<a name="line798"></a>			$destination = rtrim($destination, '/') . DIRECTORY_SEPARATOR . $pinfo['basename'];
<a name="line799"></a>		}
<a name="line800"></a>		if (is_dir($destination) === false)
<a name="line801"></a>		{
<a name="line802"></a>			mkdir($destination, 0755, true);
<a name="line803"></a>		}
<a name="line804"></a>
<a name="line805"></a>		$files = scandir($source);
<a name="line806"></a>		foreach ($files as $file)
<a name="line807"></a>		{
<a name="line808"></a>			if ($file != "." && $file != "..")
<a name="line809"></a>			{
<a name="line810"></a>				rcopy($source . DIRECTORY_SEPARATOR . $file, rtrim($destination, '/') . DIRECTORY_SEPARATOR . $file, true);
<a name="line811"></a>			}
<a name="line812"></a>		}
<a name="line813"></a>	}
<a name="line814"></a>	else
<a name="line815"></a>	{
<a name="line816"></a>		if (file_exists($source))
<a name="line817"></a>		{
<a name="line818"></a>			if (is_dir($destination) === true)
<a name="line819"></a>			{
<a name="line820"></a>				$pinfo = pathinfo($source);
<a name="line821"></a>				$dest2 = rtrim($destination, '/') . DIRECTORY_SEPARATOR . $pinfo['basename'];
<a name="line822"></a>			}
<a name="line823"></a>			else
<a name="line824"></a>			{
<a name="line825"></a>				$dest2 = $destination;
<a name="line826"></a>			}
<a name="line827"></a>
<a name="line828"></a>			copy($source, $dest2);
<a name="line829"></a>		}
<a name="line830"></a>	}
<a name="line831"></a>}
<a name="line832"></a>
<a name="line833"></a>
<a name="line834"></a>
<a name="line835"></a>
<a name="line836"></a>/**
<a name="line837"></a> * recursivly renames everything
<a name="line838"></a> *
<a name="line839"></a> * I know copy and rename could be done with just one function
<a name="line840"></a> * but i split the 2 because sometimes rename fails on windows
<a name="line841"></a> * Need more feedback from users and refactor if needed
<a name="line842"></a> *
<a name="line843"></a> * @param  string  $source
<a name="line844"></a> * @param  string  $destination
<a name="line845"></a> * @param  bool    $is_rec
<a name="line846"></a> */
<a name="line847"></a>function rrename($source, $destination, $is_rec = false)
<a name="line848"></a>{
<a name="line849"></a>	if (is_dir($source))
<a name="line850"></a>	{
<a name="line851"></a>		if ($is_rec === false)
<a name="line852"></a>		{
<a name="line853"></a>			$pinfo = pathinfo($source);
<a name="line854"></a>			$destination = rtrim($destination, '/') . DIRECTORY_SEPARATOR . $pinfo['basename'];
<a name="line855"></a>		}
<a name="line856"></a>		if (is_dir($destination) === false)
<a name="line857"></a>		{
<a name="line858"></a>			mkdir($destination, 0755, true);
<a name="line859"></a>		}
<a name="line860"></a>
<a name="line861"></a>		$files = scandir($source);
<a name="line862"></a>		foreach ($files as $file)
<a name="line863"></a>		{
<a name="line864"></a>			if ($file != "." && $file != "..")
<a name="line865"></a>			{
<a name="line866"></a>				rrename($source . DIRECTORY_SEPARATOR . $file, rtrim($destination, '/') . DIRECTORY_SEPARATOR . $file, true);
<a name="line867"></a>			}
<a name="line868"></a>		}
<a name="line869"></a>	}
<a name="line870"></a>	else
<a name="line871"></a>	{
<a name="line872"></a>		if (file_exists($source))
<a name="line873"></a>		{
<a name="line874"></a>			if (is_dir($destination) === true)
<a name="line875"></a>			{
<a name="line876"></a>				$pinfo = pathinfo($source);
<a name="line877"></a>				$dest2 = rtrim($destination, '/') . DIRECTORY_SEPARATOR . $pinfo['basename'];
<a name="line878"></a>			}
<a name="line879"></a>			else
<a name="line880"></a>			{
<a name="line881"></a>				$dest2 = $destination;
<a name="line882"></a>			}
<a name="line883"></a>
<a name="line884"></a>			rename($source, $dest2);
<a name="line885"></a>		}
<a name="line886"></a>	}
<a name="line887"></a>}
<a name="line888"></a>
<a name="line889"></a>// On windows rename leaves folders sometime
<a name="line890"></a>// This will clear leftover folders
<a name="line891"></a>// After more feedback will merge it with rrename
<a name="line892"></a>function rrename_after_cleaner($source)
<a name="line893"></a>{
<a name="line894"></a>	$files = scandir($source);
<a name="line895"></a>
<a name="line896"></a>	foreach ($files as $file)
<a name="line897"></a>	{
<a name="line898"></a>		if ($file != "." && $file != "..")
<a name="line899"></a>		{
<a name="line900"></a>			if (is_dir($source . DIRECTORY_SEPARATOR . $file))
<a name="line901"></a>			{
<a name="line902"></a>				rrename_after_cleaner($source . DIRECTORY_SEPARATOR . $file);
<a name="line903"></a>			}
<a name="line904"></a>			else
<a name="line905"></a>			{
<a name="line906"></a>				unlink($source . DIRECTORY_SEPARATOR . $file);
<a name="line907"></a>			}
<a name="line908"></a>		}
<a name="line909"></a>	}
<a name="line910"></a>
<a name="line911"></a>	return rmdir($source);
<a name="line912"></a>}
<a name="line913"></a>
<a name="line914"></a>/**
<a name="line915"></a> * Recursive chmod
<a name="line916"></a> * @param  string  $source
<a name="line917"></a> * @param  int     $mode
<a name="line918"></a> * @param  string  $rec_option
<a name="line919"></a> * @param  bool    $is_rec
<a name="line920"></a> */
<a name="line921"></a>function rchmod($source, $mode, $rec_option = "none", $is_rec = false)
<a name="line922"></a>{
<a name="line923"></a>	if ($rec_option == "none")
<a name="line924"></a>	{
<a name="line925"></a>		chmod($source, $mode);
<a name="line926"></a>	}
<a name="line927"></a>	else
<a name="line928"></a>	{
<a name="line929"></a>		if ($is_rec === false)
<a name="line930"></a>		{
<a name="line931"></a>			chmod($source, $mode);
<a name="line932"></a>		}
<a name="line933"></a>
<a name="line934"></a>		$files = scandir($source);
<a name="line935"></a>
<a name="line936"></a>		foreach ($files as $file)
<a name="line937"></a>		{
<a name="line938"></a>			if ($file != "." && $file != "..")
<a name="line939"></a>			{
<a name="line940"></a>				if (is_dir($source . DIRECTORY_SEPARATOR . $file))
<a name="line941"></a>				{
<a name="line942"></a>					if ($rec_option == "folders" || $rec_option == "both")
<a name="line943"></a>					{
<a name="line944"></a>						chmod($source . DIRECTORY_SEPARATOR . $file, $mode);
<a name="line945"></a>					}
<a name="line946"></a>					rchmod($source . DIRECTORY_SEPARATOR . $file, $mode, $rec_option, true);
<a name="line947"></a>				}
<a name="line948"></a>				else
<a name="line949"></a>				{
<a name="line950"></a>					if ($rec_option == "files" || $rec_option == "both")
<a name="line951"></a>					{
<a name="line952"></a>						chmod($source . DIRECTORY_SEPARATOR . $file, $mode);
<a name="line953"></a>					}
<a name="line954"></a>				}
<a name="line955"></a>			}
<a name="line956"></a>		}
<a name="line957"></a>	}
<a name="line958"></a>}
<a name="line959"></a>
<a name="line960"></a>/**
<a name="line961"></a> * Check if chmod is valid
<a name="line962"></a> *
<a name="line963"></a> * @param  $perm
<a name="line964"></a> * @param  $val
<a name="line965"></a> *
<a name="line966"></a> * @return  bool
<a name="line967"></a> */
<a name="line968"></a>function chmod_logic_helper($perm, $val)
<a name="line969"></a>{
<a name="line970"></a>	$valid = array(
<a name="line971"></a>		1 => array( 1, 3, 5, 7 ),
<a name="line972"></a>		2 => array( 2, 3, 6, 7 ),
<a name="line973"></a>		4 => array( 4, 5, 6, 7 )
<a name="line974"></a>	);
<a name="line975"></a>
<a name="line976"></a>	if (in_array($perm, $valid[ $val ]))
<a name="line977"></a>	{
<a name="line978"></a>		return true;
<a name="line979"></a>	}
<a name="line980"></a>	else
<a name="line981"></a>	{
<a name="line982"></a>		return false;
<a name="line983"></a>	}
<a name="line984"></a>}
<a name="line985"></a>
<a name="line986"></a>/**
<a name="line987"></a> * @param  string  $input
<a name="line988"></a> * @param  bool    $trace
<a name="line989"></a> * @param  bool    $halt
<a name="line990"></a> */
<a name="line991"></a>function debugger($input, $trace = false, $halt = false)
<a name="line992"></a>{
<a name="line993"></a>	ob_start();
<a name="line994"></a>
<a name="line995"></a>	echo "<br>----- DEBUG DUMP -----";
<a name="line996"></a>	echo "<pre>";
<a name="line997"></a>	var_dump($input);
<a name="line998"></a>	echo "</pre>";
<a name="line999"></a>
<a name="line1000"></a>	if ($trace)
<a name="line1001"></a>	{
<a name="line1002"></a>		if (is_php('5.3.6'))
<a name="line1003"></a>		{
<a name="line1004"></a>			$debug = debug_backtrace(DEBUG_BACKTRACE_IGNORE_ARGS);
<a name="line1005"></a>		}
<a name="line1006"></a>		else
<a name="line1007"></a>		{
<a name="line1008"></a>			$debug = debug_backtrace(false);
<a name="line1009"></a>		}
<a name="line1010"></a>
<a name="line1011"></a>		echo "<br>-----STACK TRACE-----";
<a name="line1012"></a>		echo "<pre>";
<a name="line1013"></a>		var_dump($debug);
<a name="line1014"></a>		echo "</pre>";
<a name="line1015"></a>	}
<a name="line1016"></a>
<a name="line1017"></a>	echo "</pre>";
<a name="line1018"></a>	echo "---------------------------<br>";
<a name="line1019"></a>
<a name="line1020"></a>	$ret = ob_get_contents();
<a name="line1021"></a>	ob_end_clean();
<a name="line1022"></a>
<a name="line1023"></a>	echo $ret;
<a name="line1024"></a>
<a name="line1025"></a>	if ($halt == true)
<a name="line1026"></a>	{
<a name="line1027"></a>		exit();
<a name="line1028"></a>	}
<a name="line1029"></a>}
<a name="line1030"></a>
<a name="line1031"></a>/**
<a name="line1032"></a> * @param  string  $version
<a name="line1033"></a> *
<a name="line1034"></a> * @return  bool
<a name="line1035"></a> */
<a name="line1036"></a>function is_php($version = '5.0.0')
<a name="line1037"></a>{
<a name="line1038"></a>	static $phpVer;
<a name="line1039"></a>	$version = (string) $version;
<a name="line1040"></a>
<a name="line1041"></a>	if ( ! isset($phpVer[ $version ]))
<a name="line1042"></a>	{
<a name="line1043"></a>		$phpVer[ $version ] = (version_compare(PHP_VERSION, $version) < 0) ? false : true;
<a name="line1044"></a>	}
<a name="line1045"></a>
<a name="line1046"></a>	return $phpVer[ $version ];
<a name="line1047"></a>}
<a name="line1048"></a></pre>
<div class="header">
<h1>RObo cosi header</h1>
<ul>
<li><a href="../overview-summary.html">Overview</a></li>
<li>Package</li><li>Class</li><li>Tree</li><li><a href="../overview-files.html">Files</a></li>
<li><a href="../deprecated-list.html">Deprecated</a></li>
<li><a href="../todo-list.html">Todo</a></li>
<li><a href="../index-all.html">Index</a></li>
</ul>
</div>

<div class="small_links">
<a href="../index.html" target="_top">Frames</a>
<a href="../source\filemanager\include\utils.php.html" target="_top">No frames</a>
</div>
<hr>

<p id="footer">This document was generated by <a href="http://peej.github.com/phpdoctor/">PHPDoctor: The PHP Documentation Creator</a></p>

</body>

</html>